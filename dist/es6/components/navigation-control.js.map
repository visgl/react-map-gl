{"version":3,"sources":["../../../src/components/navigation-control.js"],"names":["React","PropTypes","BaseControl","MapState","LINEAR_TRANSITION_PROPS","deprecateWarn","compareVersions","noop","propTypes","Object","assign","className","string","onViewStateChange","func","onViewportChange","showCompass","bool","showZoom","zoomInLabel","zoomOutLabel","compassLabel","defaultProps","VERSION_LEGACY","VERSION_1_6","getUIVersion","mapboxVersion","NavigationControl","constructor","props","_updateViewport","zoom","_context","viewport","bearing","pitch","opts","mapState","viewState","getViewportProps","_renderCompass","style","transform","_uiVersion","_renderButton","type","label","callback","children","_render","map","version","_containerRef","_onZoomIn","_onZoomOut","_onResetNorth"],"mappings":";AACA,OAAO,KAAKA,KAAZ,MAAuB,OAAvB;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,WAAP,MAAwB,gBAAxB;AAEA,OAAOC,QAAP,MAAqB,oBAArB;AACA,SAAQC,uBAAR,QAAsC,yBAAtC;AAEA,OAAOC,aAAP,MAA0B,yBAA1B;AACA,SAAQC,eAAR,QAA8B,kBAA9B;;AAIA,MAAMC,IAAI,GAAG,MAAM,CAAE,CAArB;;AAEA,MAAMC,SAAS,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBR,WAAW,CAACM,SAA9B,EAAyC;AAEzDG,EAAAA,SAAS,EAAEV,SAAS,CAACW,MAFoC;AAKzDC,EAAAA,iBAAiB,EAAEZ,SAAS,CAACa,IAL4B;AAMzDC,EAAAA,gBAAgB,EAAEd,SAAS,CAACa,IAN6B;AAQzDE,EAAAA,WAAW,EAAEf,SAAS,CAACgB,IARkC;AAUzDC,EAAAA,QAAQ,EAAEjB,SAAS,CAACgB,IAVqC;AAYzDE,EAAAA,WAAW,EAAElB,SAAS,CAACW,MAZkC;AAazDQ,EAAAA,YAAY,EAAEnB,SAAS,CAACW,MAbiC;AAczDS,EAAAA,YAAY,EAAEpB,SAAS,CAACW;AAdiC,CAAzC,CAAlB;AAiBA,MAAMU,YAAY,GAAGb,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBR,WAAW,CAACoB,YAA9B,EAA4C;AAC/DX,EAAAA,SAAS,EAAE,EADoD;AAE/DK,EAAAA,WAAW,EAAE,IAFkD;AAG/DE,EAAAA,QAAQ,EAAE,IAHqD;AAI/DC,EAAAA,WAAW,EAAE,SAJkD;AAK/DC,EAAAA,YAAY,EAAE,UALiD;AAM/DC,EAAAA,YAAY,EAAE;AANiD,CAA5C,CAArB;AA6BA,MAAME,cAAc,GAAG,CAAvB;AACA,MAAMC,WAAW,GAAG,CAApB;;AAEA,SAASC,YAAT,CAAsBC,aAAtB,EAAqD;AACnD,SAAOpB,eAAe,CAACoB,aAAD,EAAgB,OAAhB,CAAf,IAA2C,CAA3C,GAA+CF,WAA/C,GAA6DD,cAApE;AACD;;AAMD,eAAe,MAAMI,iBAAN,SAAgCzB,WAAhC,CAIb;AAIA0B,EAAAA,WAAW,CAACC,KAAD,EAAgC;AACzC,UAAMA,KAAN;;AADyC;;AAAA,uCAwB/B,MAAM;AAChB,WAAKC,eAAL,CAAqB;AAACC,QAAAA,IAAI,EAAE,KAAKC,QAAL,CAAcC,QAAd,CAAuBF,IAAvB,GAA8B;AAArC,OAArB;AACD,KA1B0C;;AAAA,wCA4B9B,MAAM;AACjB,WAAKD,eAAL,CAAqB;AAACC,QAAAA,IAAI,EAAE,KAAKC,QAAL,CAAcC,QAAd,CAAuBF,IAAvB,GAA8B;AAArC,OAArB;AACD,KA9B0C;;AAAA,2CAgC3B,MAAM;AACpB,WAAKD,eAAL,CAAqB;AAACI,QAAAA,OAAO,EAAE,CAAV;AAAaC,QAAAA,KAAK,EAAE;AAApB,OAArB;AACD,KAlC0C;;AAGzC9B,IAAAA,aAAa,CAACwB,KAAD,CAAb;AACD;;AAIDC,EAAAA,eAAe,CAACM,IAAD,EAA8B;AAC3C,UAAM;AAACH,MAAAA;AAAD,QAAa,KAAKD,QAAxB;AACA,UAAMK,QAAQ,GAAG,IAAIlC,QAAJ,CAAaM,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBuB,QAAlB,EAA4BG,IAA5B,CAAb,CAAjB;AACA,UAAME,SAAS,GAAG7B,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkB2B,QAAQ,CAACE,gBAAT,EAAlB,EAA+CnC,uBAA/C,CAAlB;AAEA,UAAMW,gBAAgB,GAAG,KAAKc,KAAL,CAAWd,gBAAX,IAA+B,KAAKiB,QAAL,CAAcjB,gBAA7C,IAAiER,IAA1F;AACA,UAAMM,iBAAiB,GACrB,KAAKgB,KAAL,CAAWhB,iBAAX,IAAgC,KAAKmB,QAAL,CAAcnB,iBAA9C,IAAmEN,IADrE;AAIAM,IAAAA,iBAAiB,CAAC;AAACyB,MAAAA;AAAD,KAAD,CAAjB;AAGAvB,IAAAA,gBAAgB,CAACuB,SAAD,CAAhB;AACD;;AAcDE,EAAAA,cAAc,GAAG;AACf,UAAM;AAACN,MAAAA;AAAD,QAAY,KAAKF,QAAL,CAAcC,QAAhC;AACA,UAAMQ,KAAK,GAAG;AAACC,MAAAA,SAAS,mBAAY,CAACR,OAAb;AAAV,KAAd;AAEA,WAAO,KAAKS,UAAL,KAAoBnB,WAApB,GACL;AAAM,MAAA,SAAS,EAAC,oBAAhB;AAAqC,qBAAY,MAAjD;AAAwD,MAAA,KAAK,EAAEiB;AAA/D,MADK,GAGL;AAAM,MAAA,SAAS,EAAC,6BAAhB;AAA8C,MAAA,KAAK,EAAEA;AAArD,MAHF;AAKD;;AAEDG,EAAAA,aAAa,CAACC,IAAD,EAAeC,KAAf,EAA8BC,QAA9B,EAAkDC,QAAlD,EAAiE;AAC5E,WACE;AACE,MAAA,GAAG,EAAEH,IADP;AAEE,MAAA,SAAS,6CAAsCA,IAAtC,CAFX;AAGE,MAAA,IAAI,EAAC,QAHP;AAIE,MAAA,KAAK,EAAEC,KAJT;AAKE,MAAA,OAAO,EAAEC;AALX,OAOGC,QAAQ,IAAI;AAAM,MAAA,SAAS,EAAC,oBAAhB;AAAqC,qBAAY;AAAjD,MAPf,CADF;AAWD;;AAEDC,EAAAA,OAAO,GAAG;AACR,UAAM;AAACtC,MAAAA,SAAD;AAAYK,MAAAA,WAAZ;AAAyBE,MAAAA,QAAzB;AAAmCC,MAAAA,WAAnC;AAAgDC,MAAAA,YAAhD;AAA8DC,MAAAA;AAA9D,QAA8E,KAAKQ,KAAzF;;AAEA,QAAI,CAAC,KAAKc,UAAV,EAAsB;AAGpB,YAAM;AAACO,QAAAA;AAAD,UAAQ,KAAKlB,QAAnB;AACA,WAAKW,UAAL,GAAkBO,GAAG,GAAGzB,YAAY,CAACyB,GAAG,CAACC,OAAL,CAAf,GAA+B3B,WAApD;AACD;;AAED,WACE;AAAK,MAAA,SAAS,8CAAuCb,SAAvC,CAAd;AAAkE,MAAA,GAAG,EAAE,KAAKyC;AAA5E,OACGlC,QAAQ,IAAI,KAAK0B,aAAL,CAAmB,SAAnB,EAA8BzB,WAA9B,EAA2C,KAAKkC,SAAhD,CADf,EAEGnC,QAAQ,IAAI,KAAK0B,aAAL,CAAmB,UAAnB,EAA+BxB,YAA/B,EAA6C,KAAKkC,UAAlD,CAFf,EAGGtC,WAAW,IACV,KAAK4B,aAAL,CAAmB,SAAnB,EAA8BvB,YAA9B,EAA4C,KAAKkC,aAAjD,EAAgE,KAAKf,cAAL,EAAhE,CAJJ,CADF;AAQD;;AAnFD;;gBAJmBb,iB,eAKAnB,S;;gBALAmB,iB,kBAMGL,Y","sourcesContent":["// @flow\nimport * as React from 'react';\nimport PropTypes from 'prop-types';\nimport BaseControl from './base-control';\n\nimport MapState from '../utils/map-state';\nimport {LINEAR_TRANSITION_PROPS} from '../utils/map-controller';\n\nimport deprecateWarn from '../utils/deprecate-warn';\nimport {compareVersions} from '../utils/version';\n\nimport type {BaseControlProps} from './base-control';\n\nconst noop = () => {};\n\nconst propTypes = Object.assign({}, BaseControl.propTypes, {\n  // Custom className\n  className: PropTypes.string,\n  // Callbacks fired when the user interacted with the map. The object passed to the callbacks\n  // contains viewport properties such as `longitude`, `latitude`, `zoom` etc.\n  onViewStateChange: PropTypes.func,\n  onViewportChange: PropTypes.func,\n  // Show/hide compass button\n  showCompass: PropTypes.bool,\n  // Show/hide zoom buttons\n  showZoom: PropTypes.bool,\n  // Custom labels assigned to the controls\n  zoomInLabel: PropTypes.string,\n  zoomOutLabel: PropTypes.string,\n  compassLabel: PropTypes.string\n});\n\nconst defaultProps = Object.assign({}, BaseControl.defaultProps, {\n  className: '',\n  showCompass: true,\n  showZoom: true,\n  zoomInLabel: 'Zoom In',\n  zoomOutLabel: 'Zoom Out',\n  compassLabel: 'Reset North'\n});\n\nexport type NavigationControlProps = BaseControlProps & {\n  className: string,\n  onViewStateChange?: Function,\n  onViewportChange?: Function,\n  showCompass: boolean,\n  showZoom: boolean,\n  zoomInLabel: string,\n  zoomOutLabel: string,\n  compassLabel: string\n};\n\ntype ViewportProps = {\n  longitude: number,\n  latitude: number,\n  zoom: number,\n  pitch: number,\n  bearing: number\n};\n\n// Mapbox version flags. CSS classes were changed in certain versions.\nconst VERSION_LEGACY = 1;\nconst VERSION_1_6 = 2;\n\nfunction getUIVersion(mapboxVersion: string): number {\n  return compareVersions(mapboxVersion, '1.6.0') >= 0 ? VERSION_1_6 : VERSION_LEGACY;\n}\n\n/*\n * PureComponent doesn't update when context changes, so\n * implementing our own shouldComponentUpdate here.\n */\nexport default class NavigationControl extends BaseControl<\n  NavigationControlProps,\n  *,\n  HTMLDivElement\n> {\n  static propTypes = propTypes;\n  static defaultProps = defaultProps;\n\n  constructor(props: NavigationControlProps) {\n    super(props);\n    // Check for deprecated props\n    deprecateWarn(props);\n  }\n\n  _uiVersion: number;\n\n  _updateViewport(opts: $Shape<ViewportProps>) {\n    const {viewport} = this._context;\n    const mapState = new MapState(Object.assign({}, viewport, opts));\n    const viewState = Object.assign({}, mapState.getViewportProps(), LINEAR_TRANSITION_PROPS);\n\n    const onViewportChange = this.props.onViewportChange || this._context.onViewportChange || noop;\n    const onViewStateChange =\n      this.props.onViewStateChange || this._context.onViewStateChange || noop;\n\n    // Call new style callback\n    onViewStateChange({viewState});\n\n    // Call old style callback\n    onViewportChange(viewState);\n  }\n\n  _onZoomIn = () => {\n    this._updateViewport({zoom: this._context.viewport.zoom + 1});\n  };\n\n  _onZoomOut = () => {\n    this._updateViewport({zoom: this._context.viewport.zoom - 1});\n  };\n\n  _onResetNorth = () => {\n    this._updateViewport({bearing: 0, pitch: 0});\n  };\n\n  _renderCompass() {\n    const {bearing} = this._context.viewport;\n    const style = {transform: `rotate(${-bearing}deg)`};\n\n    return this._uiVersion === VERSION_1_6 ? (\n      <span className=\"mapboxgl-ctrl-icon\" aria-hidden=\"true\" style={style} />\n    ) : (\n      <span className=\"mapboxgl-ctrl-compass-arrow\" style={style} />\n    );\n  }\n\n  _renderButton(type: string, label: string, callback: Function, children: any) {\n    return (\n      <button\n        key={type}\n        className={`mapboxgl-ctrl-icon mapboxgl-ctrl-${type}`}\n        type=\"button\"\n        title={label}\n        onClick={callback}\n      >\n        {children || <span className=\"mapboxgl-ctrl-icon\" aria-hidden=\"true\" />}\n      </button>\n    );\n  }\n\n  _render() {\n    const {className, showCompass, showZoom, zoomInLabel, zoomOutLabel, compassLabel} = this.props;\n\n    if (!this._uiVersion) {\n      // map may not exist if context is provided by user application (e.g. DeckGL)\n      // in which case we fallback to the most recent UI\n      const {map} = this._context;\n      this._uiVersion = map ? getUIVersion(map.version) : VERSION_1_6;\n    }\n\n    return (\n      <div className={`mapboxgl-ctrl mapboxgl-ctrl-group ${className}`} ref={this._containerRef}>\n        {showZoom && this._renderButton('zoom-in', zoomInLabel, this._onZoomIn)}\n        {showZoom && this._renderButton('zoom-out', zoomOutLabel, this._onZoomOut)}\n        {showCompass &&\n          this._renderButton('compass', compassLabel, this._onResetNorth, this._renderCompass())}\n      </div>\n    );\n  }\n}\n"],"file":"navigation-control.js"}